
<!doctype html>
<html lang="ro">
  <head>
    <!-- Static SEO Tags - Fallbacks for initial page load -->
    <title>MusicGift.ro - Cadouri Muzicale Personalizate</title>
    <meta name="description" content="Creează melodii personalizate și cadouri muzicale unice. Servicii profesionale de compoziție. Peste 2000 melodii create cu dragoste." />
    
    <!-- Open Graph Meta Tags -->
<meta property="og:title" content="MusicGift – Personalized Songs by Mango Records" />
<meta property="og:description" content="Create emotional and unique musical gifts, crafted just for your story. Explore our custom song packages!" />
<meta property="og:image" content="https://www.musicgift.ro/uploads/logo.png" />
<meta property="og:image:type" content="logo" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:url" content="https://www.musicgift.ro/" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="ro_RO" />
<meta property="og:site_name" content="MusicGift" />
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Critical Resource Preloads for LCP Optimization -->
    <link rel="preload" href="/uploads/logo_musicgift.webp" as="image" type="image/webp" fetchpriority="high">
    <link rel="preload" href="/uploads/video_placeholder.png" as="image" type="image/png" fetchpriority="high">
    <link rel="preload" href="/uploads/background.webp" as="image" type="image/webp" fetchpriority="high">
    
    <!-- Critical Video Resources -->
    <link rel="preload" href="/uploads/musicgift_ro.mp4" as="video" type="video/mp4" fetchpriority="high">
    <link rel="preload" href="/uploads/musicgift_eng.mp4" as="video" type="video/mp4" fetchpriority="high">
    
    <!-- Enhanced DNS Prefetch for Performance -->
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://conversations-widget.brevo.com">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link rel="dns-prefetch" href="https://www.googletagmanager.com">
    
    <!-- Critical Preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Optimized Font Loading -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"></noscript>
    
    <!-- Module Preload -->
    <link rel="modulepreload" href="/src/main.tsx" fetchpriority="high">
    
    <!-- Enhanced Critical CSS for CLS Prevention -->
    <style>
      /* Critical CSS for Core Web Vitals optimization */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      
      html {
        scroll-behavior: smooth;
      }
      
      body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        line-height: 1.5;
        background-image: url('/uploads/background.webp');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        background-attachment: fixed;
        text-rendering: optimizeSpeed;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        font-display: swap;
        min-height: 100vh;
        contain: layout style paint;
      }
      
      /* Root App Container Stability */
      #root {
        min-height: 100vh;
        contain: layout style;
      }
      
      /* Critical logo styles for LCP optimization */
      .logo-critical {
        width: 8rem;
        height: auto;
        transition: transform 0.3s ease;
        will-change: transform;
        content-visibility: auto;
        contain-intrinsic-size: 256px 64px;
        contain: layout style paint;
        transform: translate3d(0, 0, 0);
        backface-visibility: hidden;
        aspect-ratio: 4 / 1;
      }
      
      @media (min-width: 640px) {
        .logo-critical { width: 10rem; }
      }
      
      @media (min-width: 768px) {
        .logo-critical { width: 12rem; }
      }
      
      @media (min-width: 1024px) {
        .logo-critical { width: 15rem; }
      }
      
      /* Critical navigation styles */
      .nav-critical {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 50;
        background: rgba(0, 0, 0, 0.9);
        backdrop-filter: blur(8px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        will-change: transform;
        contain: layout style paint;
        isolation: isolate;
        height: 4rem;
        min-height: 4rem;
      }
      
      /* Video Hero Critical Styles with Aspect Ratio */
      .video-hero-critical {
        height: 60vh;
        position: relative;
        overflow: hidden;
        content-visibility: auto;
        contain-intrinsic-size: 100vw 60vh;
        contain: layout style paint;
        background-color: #000;
        background-image: url('/uploads/video_placeholder.png');
        background-size: cover;
        background-position: center;
        aspect-ratio: 16/9;
      }
      
      @media (min-width: 640px) {
        .video-hero-critical { 
          height: 70vh;
          contain-intrinsic-size: 100vw 70vh;
        }
      }
      
      @media (min-width: 768px) {
        .video-hero-critical { 
          height: 80vh;
          contain-intrinsic-size: 100vw 80vh;
        }
      }
      
      @media (min-width: 1024px) {
        .video-hero-critical { 
          height: 100vh;
          contain-intrinsic-size: 100vw 100vh;
        }
      }
      
      /* Mobile Video Optimization */
      @media (max-width: 768px) {
        .video-hero-critical {
          height: 56.25vw;
          max-height: 100vh;
          aspect-ratio: 16/9;
        }
      }
      
      /* Main Content LCP Critical */
      .main-lcp-critical {
        background-image: url('/uploads/background.webp');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        background-attachment: fixed;
        contain: layout style paint;
        content-visibility: auto;
        min-height: 100vh;
        position: relative;
      }
      
      /* Cookie Banner Space Reservation */
      .cookie-banner-space {
        min-height: 140px;
        contain: layout style;
        content-visibility: auto;
        contain-intrinsic-size: 100vw 140px;
      }
      
      /* Hardware Acceleration */
      .hw-accelerated, .transform-gpu {
        transform: translate3d(0, 0, 0);
        will-change: transform;
        backface-visibility: hidden;
        perspective: 1000px;
      }
      
      /* Layout Stability */
      .content-container, .section-container {
        contain: layout style;
        content-visibility: auto;
      }
      
      .overlay-container {
        position: absolute;
        inset: 0;
        background: rgba(0, 0, 0, 0.4);
        contain: layout style paint;
        pointer-events: none;
      }
      
      /* Loading Skeleton */
      .loading-skeleton {
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0.1) 25%,
          rgba(255, 255, 255, 0.2) 50%,
          rgba(255, 255, 255, 0.1) 75%
        );
        background-size: 200% 100%;
        animation: shimmer 1.5s infinite;
        contain: layout style paint;
      }
      
      @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
      
      /* Critical Button Styles */
      button {
        touch-action: manipulation;
        will-change: transform;
        transition: transform 0.15s ease-out;
        cursor: pointer;
        contain: layout style;
      }
      
      button:hover {
        transform: translate3d(0, -1px, 0);
      }
      
      /* Accessibility */
      :focus-visible {
        outline: 2px solid #3b82f6;
        outline-offset: 2px;
      }
      
      /* Statistics Section */
      .stats-section {
        min-height: 80px;
        contain: layout style;
        content-visibility: auto;
        contain-intrinsic-size: 100vw 80px;
      }
      
      /* Text Stability */
      .text-stability {
        font-size-adjust: 0.5;
        line-height: 1.5;
        contain: layout style;
      }
      
      /* Reduced Motion */
      @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }
        
        .loading-skeleton {
          animation: none;
          background: rgba(255, 255, 255, 0.1);
        }
      }
    </style>
  </head>
  
  <body>
    <div id="root"></div>
    
    <!-- Optimized script loading -->
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Deferred Performance Scripts -->
    <script>
      // Optimized script loader with enhanced performance monitoring
      class OptimizedScriptLoader {
        constructor() {
          this.loadedScripts = new Set();
          this.pendingScripts = new Map();
          this.performanceObserver = null;
          this.initializePerformanceMonitoring();
          this.initializeOnInteraction();
        }
        
        initializePerformanceMonitoring() {
          // Core Web Vitals monitoring
          if ('PerformanceObserver' in window) {
            try {
              // LCP monitoring
              const lcpObserver = new PerformanceObserver((list) => {
                const entries = list.getEntries();
                const lastEntry = entries[entries.length - 1];
                console.log('LCP:', lastEntry.startTime);
              });
              lcpObserver.observe({ entryTypes: ['largest-contentful-paint'] });
              
              // CLS monitoring
              const clsObserver = new PerformanceObserver((list) => {
                let clsValue = 0;
                for (const entry of list.getEntries()) {
                  if (!entry.hadRecentInput) {
                    clsValue += entry.value;
                  }
                }
                console.log('CLS:', clsValue);
              });
              clsObserver.observe({ entryTypes: ['layout-shift'] });
              
              // FID monitoring
              const fidObserver = new PerformanceObserver((list) => {
                for (const entry of list.getEntries()) {
                  console.log('FID:', entry.processingStart - entry.startTime);
                }
              });
              fidObserver.observe({ entryTypes: ['first-input'] });
            } catch (e) {
              console.warn('Performance monitoring failed:', e);
            }
          }
        }
        
        initializeOnInteraction() {
          const events = ['scroll', 'mouseover', 'touchstart', 'keydown'];
          const onFirstInteraction = () => {
            this.loadNonCriticalScripts();
            events.forEach(event => 
              document.removeEventListener(event, onFirstInteraction, { passive: true })
            );
          };
          
          events.forEach(event => 
            document.addEventListener(event, onFirstInteraction, { passive: true })
          );
          
          // Fallback with longer delay for better initial performance
          setTimeout(onFirstInteraction, 5000);
        }
        
        loadNonCriticalScripts() {
          // Load Analytics with enhanced error handling
          this.loadScript('https://www.googletagmanager.com/gtag/js?id=G-EHVL7BL5FS', () => {
            try {
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'G-EHVL7BL5FS', {
                page_title: document.title,
                page_location: window.location.href,
                send_page_view: true
              });
            } catch (e) {
              console.warn('Analytics initialization failed:', e);
            }
          });
          
          // Load Brevo Conversations with increased delay
          setTimeout(() => {
            try {
              (function(d, w, c) {
                w.BrevoConversationsID = '68374d9e93ba39a2030dfb0e';
                w[c] = w[c] || function() {
                  (w[c].q = w[c].q || []).push(arguments);
                };
                var s = d.createElement('script');
                s.async = true;
                s.defer = true;
                s.src = 'https://conversations-widget.brevo.com/brevo-conversations.js';
                s.onerror = () => console.warn('Brevo widget failed to load');
                if (d.head) d.head.appendChild(s);
              })(document, window, 'BrevoConversations');
            } catch (e) {
              console.warn('Brevo conversations failed to initialize:', e);
            }
          }, 8000);
        }
        
        loadScript(src, callback) {
          if (this.loadedScripts.has(src)) {
            callback && callback();
            return;
          }
          
          if (this.pendingScripts.has(src)) {
            this.pendingScripts.get(src).push(callback);
            return;
          }
          
          this.pendingScripts.set(src, callback ? [callback] : []);
          
          const script = document.createElement('script');
          script.src = src;
          script.async = true;
          script.defer = true;
          
          script.onload = () => {
            this.loadedScripts.add(src);
            const callbacks = this.pendingScripts.get(src) || [];
            callbacks.forEach(cb => cb && cb());
            this.pendingScripts.delete(src);
          };
          
          script.onerror = () => {
            console.warn('Failed to load script:', src);
            this.pendingScripts.delete(src);
          };
          
          document.head.appendChild(script);
        }
      }
      
      // Initialize with DOM ready check
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => new OptimizedScriptLoader());
      } else {
        new OptimizedScriptLoader();
      }
    </script>
  </body>
</html>
